<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/mongo-express/mongo-express#readme"

    >mongo-express (v0.39.2)</a>
</h1>
<h4>Web-based admin interface for MongoDB</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.mongo-express">module mongo-express</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.csv">
            function <span class="apidocSignatureSpan">mongo-express.</span>csv
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.db">
            function <span class="apidocSignatureSpan">mongo-express.</span>db
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.middleware">
            function <span class="apidocSignatureSpan">mongo-express.</span>middleware
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.router">
            function <span class="apidocSignatureSpan">mongo-express.</span>router
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mongo-express.</span>bson</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mongo-express.</span>filters</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mongo-express.</span>json</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mongo-express.</span>utils</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mongo-express.bson">module mongo-express.bson</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.bson.getSandbox">
            function <span class="apidocSignatureSpan">mongo-express.bson.</span>getSandbox
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.bson.hexToObjectId">
            function <span class="apidocSignatureSpan">mongo-express.bson.</span>hexToObjectId
            <span class="apidocSignatureSpan">(string)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.bson.toBSON">
            function <span class="apidocSignatureSpan">mongo-express.bson.</span>toBSON
            <span class="apidocSignatureSpan">(string)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.bson.toJsonString">
            function <span class="apidocSignatureSpan">mongo-express.bson.</span>toJsonString
            <span class="apidocSignatureSpan">(doc)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.bson.toObjectId">
            function <span class="apidocSignatureSpan">mongo-express.bson.</span>toObjectId
            <span class="apidocSignatureSpan">(string)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.bson.toSafeBSON">
            function <span class="apidocSignatureSpan">mongo-express.bson.</span>toSafeBSON
            <span class="apidocSignatureSpan">(string)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.bson.toString">
            function <span class="apidocSignatureSpan">mongo-express.bson.</span>toString
            <span class="apidocSignatureSpan">(doc)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mongo-express.csv">module mongo-express.csv</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.csv.csv">
            function <span class="apidocSignatureSpan">mongo-express.</span>csv
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mongo-express.db">module mongo-express.db</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.db.db">
            function <span class="apidocSignatureSpan">mongo-express.</span>db
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mongo-express.filters">module mongo-express.filters</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.filters.convertBytes">
            function <span class="apidocSignatureSpan">mongo-express.filters.</span>convertBytes
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.filters.is_embeddedDocumentNotation">
            function <span class="apidocSignatureSpan">mongo-express.filters.</span>is_embeddedDocumentNotation
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.filters.json">
            function <span class="apidocSignatureSpan">mongo-express.filters.</span>json
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.filters.stringDocIDs">
            function <span class="apidocSignatureSpan">mongo-express.filters.</span>stringDocIDs
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.filters.to_display">
            function <span class="apidocSignatureSpan">mongo-express.filters.</span>to_display
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.filters.to_string">
            function <span class="apidocSignatureSpan">mongo-express.filters.</span>to_string
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mongo-express.json">module mongo-express.json</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.json.stringify">
            function <span class="apidocSignatureSpan">mongo-express.json.</span>stringify
            <span class="apidocSignatureSpan">(value, replacer, space)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mongo-express.middleware">module mongo-express.middleware</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.middleware.middleware">
            function <span class="apidocSignatureSpan">mongo-express.</span>middleware
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mongo-express.router">module mongo-express.router</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.router.router">
            function <span class="apidocSignatureSpan">mongo-express.</span>router
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mongo-express.utils">module mongo-express.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.utils.buildCollectionURL">
            function <span class="apidocSignatureSpan">mongo-express.utils.</span>buildCollectionURL
            <span class="apidocSignatureSpan">(base, dbName, collectionName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.utils.bytesToSize">
            function <span class="apidocSignatureSpan">mongo-express.utils.</span>bytesToSize
            <span class="apidocSignatureSpan">(bytes)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.utils.colsToGrid">
            function <span class="apidocSignatureSpan">mongo-express.utils.</span>colsToGrid
            <span class="apidocSignatureSpan">(cols)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.utils.deepmerge">
            function <span class="apidocSignatureSpan">mongo-express.utils.</span>deepmerge
            <span class="apidocSignatureSpan">(target, src)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mongo-express.utils.roughSizeOfObject">
            function <span class="apidocSignatureSpan">mongo-express.utils.</span>roughSizeOfObject
            <span class="apidocSignatureSpan">(object)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mongo-express" id="apidoc.module.mongo-express">module mongo-express</a></h1>


    <h2>
        <a href="#apidoc.element.mongo-express.csv" id="apidoc.element.mongo-express.csv">
        function <span class="apidocSignatureSpan">mongo-express.</span>csv
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">csv = function (data) {
  for (var i = 0, ii = data.length; i &#x3c; ii; i++) {
    var current = data[i];
    handleObject(current);
    data[i] = flat(current, { safe: true });
  }
  return csv({ data: data });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.db" id="apidoc.element.mongo-express.db">
        function <span class="apidocSignatureSpan">mongo-express.</span>db
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">db = function (config) {
  // set up database stuff
  let host = config.mongodb.server  || &#x27;localhost&#x27;;
  let port = config.mongodb.port    || mongodb.Connection.DEFAULT_PORT;

  if (config.mongodb.useSSL) {
    console.error(&#x27;Please update config file to use mongodb.ssl instead of mongodb.useSSL. Copying value for now.&#x27;);
    config.mongodb.ssl = config.mongodb.useSSL;
  }

  let dbOptions = {
    auto_reconnect: config.mongodb.autoReconnect,
    poolSize:       config.mongodb.poolSize,
    ssl:            config.mongodb.ssl,
    sslValidate:    config.mongodb.sslValidate,
    sslCA:          config.mongodb.sslCA,
  };

  let db;

  if (Array.isArray(host)) {
    host = host.map(function (host) {
      return new mongodb.Server(host, port, dbOptions);
    });

    db = new mongodb.Db(&#x27;local&#x27;, new mongodb.ReplSet(host), { safe: true, w: 0 });
  } else {
    db = new mongodb.Db(&#x27;local&#x27;, new mongodb.Server(host, port, dbOptions), { safe: true });
  }

  let collections     = {};
  let connections     = {};
  let databases       = [];

  let adminDb = db.admin();
  let mainConn  = db; // main db connection

  // update the collections list
  let updateCollections = function (db, dbName, callback) {
    db.listCollections().toArray(function (err, result) {
      let names = [];

      for (let r in result) {
        names.push(result[r].name);
      }

      collections[dbName] = names.sort();

      if (callback) {
        callback(err);
      }
    });
  };

  // update database list
  let updateDatabases = function (admin, callback) {

    admin.listDatabases(function (err, dbs) {
      databases = [];
      if (err) {
        //TODO: handle error
        console.error(err);
        databases = _.map(config.mongodb.auth, &#x27;database&#x27;);
      } else {
        for (let i = 0; i &#x3c; dbs.databases.length; i++) {
          let dbName = dbs.databases[i].name;

          if (config.mongodb.whitelist.length !== 0) {
            if (!_.includes(config.mongodb.whitelist, dbName)) {
              continue;
            }
          }

          if (config.mongodb.blacklist.length !== 0) {
            if (_.includes(config.mongodb.blacklist, dbName)) {
              continue;
            }
          }

          connections[dbName] = mainConn.db(dbName);
          databases.push(dbName);
          updateCollections(connections[dbName], dbName);
        }
      }

      //Sort database names
      databases = databases.sort();

      if (callback) {
        callback(databases);
      }
    });
  };

  // connect to mongodb database
  db.open(function (err, db) {
    if (err) {
      throw err;
    }

    if (config.options.console) console.log(&#x27;Database connected&#x27;);

    mainConn = db;

    //Check if admin features are on
    if (config.mongodb.admin === true) {

      if (config.mongodb.adminUsername.length === 0) {
        if (config.options.console) console.log(&#x27;Admin Database connected&#x27;);
        updateDatabases(adminDb);
      } else {
        //auth details were supplied, authenticate admin account with them
        adminDb.authenticate(config.mongodb.adminUsername, config.mongodb.adminPassword, function (err) {
          if (err) {
            //TODO: handle error
            console.error(err);
          }

          if (config.options.console) console.log(&#x27;Admin Database connected&#x27;);
          updateDatabases(adminDb);
        });
      }
    } else {
      //Regular user authentication
      if (typeof config.mongodb.auth === &#x27;undefined&#x27; || config.mongodb.auth.length === 0) {
        throw new Error(&#x27;Add auth details to config or turn on admin!&#x27;);
      }

      async.forEachSeries(config.mongodb.auth, function (auth, callback) {
        if (config.options.console) console.log(&#x27;Connecting to &#x27; + auth.database + &#x27;...&#x27;);
        connections[auth.database] = mainConn.db(auth.database);
        databases.push(auth.database);

        if (typeof auth.username !== &#x27;undefined&#x27; &#x26;&#x26; auth.username.length !== 0) {
          connections[auth.database].authenticate(auth.username, auth.password, function (err, success) {
            if (err) { ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...

    if (config.mongodb.blacklist.length !== 0) {
      if (_.includes(config.mongodb.blacklist, dbName)) {
        continue;
      }
    }

    connections[dbName] = mainConn.<span class="apidocCodeKeywordSpan">db</span>(dbName);
    databases.push(dbName);
    updateCollections(connections[dbName], dbName);
  }
}

//Sort database names
databases = databases.sort();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.middleware" id="apidoc.element.mongo-express.middleware">
        function <span class="apidocSignatureSpan">mongo-express.</span>middleware
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">middleware = function (config) {
  const app = express();

  app.locals.assets = assets;

  //Set up swig
  const swigOptions = {
    cache: process.env.NODE_ENV === &#x27;production&#x27; ? &#x27;memory&#x27; : false,
  };
  const swigEngine = new swig.Swig(swigOptions);
  app.engine(&#x27;html&#x27;, swigEngine.renderFile);
  Object.keys(swigFilters).forEach(function (name) {
    swig.setFilter(name, swigFilters[name]);
  });

  //App configuration
  app.set(&#x27;views&#x27;, __dirname + &#x27;/views&#x27;);
  app.set(&#x27;view engine&#x27;, &#x27;html&#x27;);
  app.set(&#x27;view options&#x27;, { layout: false });

  app.use(&#x27;/&#x27;, router(config));

  app.set(&#x27;read_only&#x27;,      config.options.readOnly      || false);
  app.set(&#x27;gridFSEnabled&#x27;,  config.options.gridFSEnabled || false);

  return app;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.router" id="apidoc.element.mongo-express.router">
        function <span class="apidocSignatureSpan">mongo-express.</span>router
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">router = function (config) {
  // appRouter configuration
  const appRouter = express.Router();
  const mongo = db(config);

  if (config.useBasicAuth) {
    appRouter.use(basicAuth(config.basicAuth.username, config.basicAuth.password));
  }

  appRouter.use(favicon(__dirname + &#x27;/../public/images/favicon.ico&#x27;));

  appRouter.use(logger(&#x27;dev&#x27;, config.options.logger));

  appRouter.use(&#x27;/public&#x27;, express.static(__dirname + &#x27;/../build/&#x27;));

  // Set request size limit
  appRouter.use(bodyParser.urlencoded({
    extended: true,
    limit: config.site.requestSizeLimit,
  }));

  appRouter.use(cookieParser(config.site.cookieSecret));

  appRouter.use(session({
    key: config.site.cookieKeyName,
    resave: true,
    saveUninitialized: true,
    secret: config.site.sessionSecret,
  }));

  appRouter.use(methodOverride(function (req) {
    if (req.body &#x26;&#x26; typeof req.body === &#x27;object&#x27; &#x26;&#x26; &#x27;_method&#x27; in req.body) {
      // look in urlencoded POST bodies and delete it
      const method = req.body._method;
      delete req.body._method;
      return method;
    }
  }));

  if (process.env.NODE_ENV === &#x27;development&#x27;) {
    appRouter.use(errorHandler());
  }

  const addTrailingSlash = function (s) {
    return s + (s[s.length - 1] === &#x27;/&#x27; ? &#x27;&#x27; : &#x27;/&#x27;);
  };
  const buildBaseHref = function (originalUrl, reqUrl) {
    if (reqUrl === &#x27;/&#x27;) {
      return addTrailingSlash(originalUrl);
    }
    const idx = originalUrl.lastIndexOf(reqUrl);
    const rootPath = originalUrl.substring(0, idx);
    return addTrailingSlash(rootPath);
  };

  // View helper, sets local variables used in templates
  appRouter.all(&#x27;*&#x27;, function (req, res, next) {
    res.locals.baseHref       = buildBaseHref(req.originalUrl, req.url);
    res.locals.databases      = mongo.databases;
    res.locals.collections    = mongo.collections;
    res.locals.gridFSBuckets  = utils.colsToGrid(mongo.collections);

    // Flash messages
    if (req.session.success) {
      res.locals.messageSuccess = req.session.success;
      delete req.session.success;
    }

    if (req.session.error) {
      res.locals.messageError = req.session.error;
      delete req.session.error;
    }

    if (config.mongodb.admin !== true) return next();

    mongo.updateDatabases(mongo.adminDb, function (databases) {
      mongo.databases = databases;
      res.locals.databases = mongo.databases;
      return next();
    });
  });

  // route param pre-conditions
  appRouter.param(&#x27;database&#x27;, function (req, res, next, id) {
    //Make sure database exists
    if (!_.includes(mongo.databases, id)) {
      req.session.error = &#x27;Database not found!&#x27;;
      return res.redirect(res.locals.baseHref);
    }

    req.dbName = id;
    res.locals.dbName = id;

    if (mongo.connections[id] !== undefined) {
      req.db = mongo.connections[id];
    } else {
      mongo.connections[id] = mongo.mainConn.db(id);
      req.db = mongo.connections[id];
    }

    next();
  });

  // :collection param MUST be preceded by a :database param
  appRouter.param(&#x27;collection&#x27;, function (req, res, next, id) {
    //Make sure collection exists

    if (!_.includes(mongo.collections[req.dbName], id)) {
      req.session.error = &#x27;Collection not found!&#x27;;
      return res.redirect(res.locals.baseHref + &#x27;db/&#x27; + req.dbName);
    }

    req.collectionName = id;
    res.locals.collectionName = id;
    res.locals.collections = mongo.collections[req.dbName];
    res.locals.gridFSBuckets = utils.colsToGrid(mongo.collections[req.dbName]);

    mongo.connections[req.dbName].collection(id, function (err, coll) {
      if (err || coll === null) {
        req.session.error = &#x27;Collection not found!&#x27;;
        return res.redirect(res.locals.baseHref + &#x27;db/&#x27; + req.dbName);
      }

      req.collection = coll;

      next();
    });
  });

  // :document param MUST be preceded by a :collection param
  appRouter.param(&#x27;document&#x27;, function (req, res, next, id) {
    if (id === &#x27;undefined&#x27; || id === undefined) {
      req.session.error = &#x27;Document lacks an _id!&#x27;;
      return res.redirect(res.locals.baseHref + &#x27;db/&#x27; + req.dbName + &#x27;/&#x27; + req.collectionName); ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>










</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mongo-express.bson" id="apidoc.module.mongo-express.bson">module mongo-express.bson</a></h1>


    <h2>
        <a href="#apidoc.element.mongo-express.bson.getSandbox" id="apidoc.element.mongo-express.bson.getSandbox">
        function <span class="apidocSignatureSpan">mongo-express.bson.</span>getSandbox
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getSandbox = function () {
  return {
    Long: mongodb.Long,
    NumberLong: mongodb.Long,
    Double: mongodb.Double,
    NumberDouble: mongodb.Double,
    ObjectId: mongodb.ObjectID,
    ObjectID: mongodb.ObjectID,
    Timestamp: Timestamp,
    DBRef: DBRef,
    Dbref: DBRef,
    Binary: mongodb.Binary,
    BinData: mongodb.Binary,
    Code: mongodb.Code,
    Symbol: mongodb.Symbol,
    MinKey: mongodb.MinKey,
    MaxKey: mongodb.MaxKey,
    ISODate: Date,
    Date: Date,
    Buffer: Buffer,
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};
};

//JSON.parse doesn&#x27;t support BSON data types
//Document is evaluated in a vm in order to support BSON data types
//Sandbox contains BSON data type functions from node-mongodb-native
exports.toBSON = function (string) {
var sandbox = exports.<span class="apidocCodeKeywordSpan">getSandbox</span>();

string = string.replace(/ISODate\(/g, &#x27;new ISODate(&#x27;);
string = string.replace(/Binary\((&#x22;[^&#x22;]+&#x22;),/g, &#x27;Binary(new Buffer($1, &#x22;base64&#x22;),&#x27;);

vm.runInNewContext(&#x27;doc = eval((&#x27; + string + &#x27;));&#x27;, sandbox);

return sandbox.doc;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.bson.hexToObjectId" id="apidoc.element.mongo-express.bson.hexToObjectId">
        function <span class="apidocSignatureSpan">mongo-express.bson.</span>hexToObjectId
        <span class="apidocSignatureSpan">(string)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hexToObjectId = function (string) {
  if (!/^[0-9a-f]{24}$/.test(string)) {
    return false;
  }
  var sandbox = exports.getSandbox();
  return sandbox.ObjectID(string);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.bson.toBSON" id="apidoc.element.mongo-express.bson.toBSON">
        function <span class="apidocSignatureSpan">mongo-express.bson.</span>toBSON
        <span class="apidocSignatureSpan">(string)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toBSON = function (string) {
  var sandbox = exports.getSandbox();

  string = string.replace(/ISODate\(/g, &#x27;new ISODate(&#x27;);
  string = string.replace(/Binary\((&#x22;[^&#x22;]+&#x22;),/g, &#x27;Binary(new Buffer($1, &#x22;base64&#x22;),&#x27;);

  vm.runInNewContext(&#x27;doc = eval((&#x27; + string + &#x27;));&#x27;, sandbox);

  return sandbox.doc;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

// This function as the name suggests attempts to parse
// the free form string in to BSON, since the possibilities of failure
// are higher, this function uses a try..catch
exports.toSafeBSON = function (string) {
  try {
    var bsonObject = exports.<span class="apidocCodeKeywordSpan">toBSON</span>(string);
    return bsonObject;
  } catch (err) {
    return null;
  }
};

// Converts string to ObjectID.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.bson.toJsonString" id="apidoc.element.mongo-express.bson.toJsonString">
        function <span class="apidocSignatureSpan">mongo-express.bson.</span>toJsonString
        <span class="apidocSignatureSpan">(doc)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toJsonString = function (doc) {
  let sJson = json.stringify(doc, null);
  sJson = sJson.replace(/ObjectID\(([^)]+)\)/g, &#x27;{ &#x22;$oid&#x22;: $1 }&#x27;);
  sJson = sJson.replace(/DBRef\(([^)]+)\)/g, &#x27;{ &#x22;$ref&#x22;: $1 }&#x27;);
  sJson = sJson.replace(/ISODate\(([^)]+)\)/g, &#x27;$1&#x27;);
  return sJson;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.bson.toObjectId" id="apidoc.element.mongo-express.bson.toObjectId">
        function <span class="apidocSignatureSpan">mongo-express.bson.</span>toObjectId
        <span class="apidocSignatureSpan">(string)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toObjectId = function (string) {
  var sandbox = exports.getSandbox();

  // Validation
  if (
    !string ||                                            // No input at all
    string === &#x27;&#x27; ||                                      // empty string
    string.toUpperCase().indexOf(&#x27;OBJECTID(&#x27;) === -1 ||   // missing the opening &#x27;ObjectID(&#x27;
    string.indexOf(&#x27;)&#x27;) === -1                            // missing the closing &#x27;(&#x27;
  ) {
    return false;
  }

  // Strip quotes
  string = string.replace(&#x27;&#x22;&#x27;, &#x27;&#x27;).replace(&#x27;&#x22;&#x27;, &#x27;&#x27;);

  // Convert ObjectId(&#x22;526ddf5a9f610ffd26000001&#x22;) to 526ddf5a9f610ffd26000001
  string = string.replace(/ObjectID\(/i, &#x27;&#x27;).replace(&#x27;)&#x27;, &#x27;&#x27;);

  // Make sure it&#x27;s a 24-character string to prevent errors.
  if (string.length === 24) {
    return sandbox.ObjectID(string);
  } else {
    return false;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var DBRef = function (namespace, oid, db) {
  //Allow empty/undefined db value
  if (db === undefined || db === null) {
    db = &#x27;&#x27;;
  }

  var objectId = exports.<span class="apidocCodeKeywordSpan">toObjectId</span>(oid);
  if (objectId === false) {
    objectId = mongodb.ObjectId(oid);
  }
  return mongodb.DBRef(namespace, objectId, db);
};

var Timestamp = function (high, low) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.bson.toSafeBSON" id="apidoc.element.mongo-express.bson.toSafeBSON">
        function <span class="apidocSignatureSpan">mongo-express.bson.</span>toSafeBSON
        <span class="apidocSignatureSpan">(string)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toSafeBSON = function (string) {
  try {
    var bsonObject = exports.toBSON(string);
    return bsonObject;
  } catch (err) {
    return null;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.bson.toString" id="apidoc.element.mongo-express.bson.toString">
        function <span class="apidocSignatureSpan">mongo-express.bson.</span>toString
        <span class="apidocSignatureSpan">(doc)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toString = function (doc) {
  //Use custom json stringify function from json.js
  return json.stringify(doc, null, &#x27;    &#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
exports.json = function (input) {
return JSON.stringify(input, null, &#x27;    &#x27;);
};

exports.convertBytes = function (input) {
input = parseInt(input, 10);
if (input &#x3c; 1024) {
  return input.<span class="apidocCodeKeywordSpan">toString</span>() + &#x27; Bytes&#x27;;
} else if (input &#x3c; 1024 * 1024) {
  //Convert to KB and keep 2 decimal values
  input = Math.round((input / 1024) * 100) / 100;
  return input.toString() + &#x27; KB&#x27;;
} else if (input &#x3c; 1024 * 1024 * 1024) {
  input = Math.round((input / (1024 * 1024)) * 100) / 100;
  return input.toString() + &#x27; MB&#x27;;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mongo-express.csv" id="apidoc.module.mongo-express.csv">module mongo-express.csv</a></h1>


    <h2>
        <a href="#apidoc.element.mongo-express.csv.csv" id="apidoc.element.mongo-express.csv.csv">
        function <span class="apidocSignatureSpan">mongo-express.</span>csv
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">csv = function (data) {
  for (var i = 0, ii = data.length; i &#x3c; ii; i++) {
    var current = data[i];
    handleObject(current);
    data[i] = flat(current, { safe: true });
  }
  return csv({ data: data });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mongo-express.db" id="apidoc.module.mongo-express.db">module mongo-express.db</a></h1>


    <h2>
        <a href="#apidoc.element.mongo-express.db.db" id="apidoc.element.mongo-express.db.db">
        function <span class="apidocSignatureSpan">mongo-express.</span>db
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">db = function (config) {
  // set up database stuff
  let host = config.mongodb.server  || &#x27;localhost&#x27;;
  let port = config.mongodb.port    || mongodb.Connection.DEFAULT_PORT;

  if (config.mongodb.useSSL) {
    console.error(&#x27;Please update config file to use mongodb.ssl instead of mongodb.useSSL. Copying value for now.&#x27;);
    config.mongodb.ssl = config.mongodb.useSSL;
  }

  let dbOptions = {
    auto_reconnect: config.mongodb.autoReconnect,
    poolSize:       config.mongodb.poolSize,
    ssl:            config.mongodb.ssl,
    sslValidate:    config.mongodb.sslValidate,
    sslCA:          config.mongodb.sslCA,
  };

  let db;

  if (Array.isArray(host)) {
    host = host.map(function (host) {
      return new mongodb.Server(host, port, dbOptions);
    });

    db = new mongodb.Db(&#x27;local&#x27;, new mongodb.ReplSet(host), { safe: true, w: 0 });
  } else {
    db = new mongodb.Db(&#x27;local&#x27;, new mongodb.Server(host, port, dbOptions), { safe: true });
  }

  let collections     = {};
  let connections     = {};
  let databases       = [];

  let adminDb = db.admin();
  let mainConn  = db; // main db connection

  // update the collections list
  let updateCollections = function (db, dbName, callback) {
    db.listCollections().toArray(function (err, result) {
      let names = [];

      for (let r in result) {
        names.push(result[r].name);
      }

      collections[dbName] = names.sort();

      if (callback) {
        callback(err);
      }
    });
  };

  // update database list
  let updateDatabases = function (admin, callback) {

    admin.listDatabases(function (err, dbs) {
      databases = [];
      if (err) {
        //TODO: handle error
        console.error(err);
        databases = _.map(config.mongodb.auth, &#x27;database&#x27;);
      } else {
        for (let i = 0; i &#x3c; dbs.databases.length; i++) {
          let dbName = dbs.databases[i].name;

          if (config.mongodb.whitelist.length !== 0) {
            if (!_.includes(config.mongodb.whitelist, dbName)) {
              continue;
            }
          }

          if (config.mongodb.blacklist.length !== 0) {
            if (_.includes(config.mongodb.blacklist, dbName)) {
              continue;
            }
          }

          connections[dbName] = mainConn.db(dbName);
          databases.push(dbName);
          updateCollections(connections[dbName], dbName);
        }
      }

      //Sort database names
      databases = databases.sort();

      if (callback) {
        callback(databases);
      }
    });
  };

  // connect to mongodb database
  db.open(function (err, db) {
    if (err) {
      throw err;
    }

    if (config.options.console) console.log(&#x27;Database connected&#x27;);

    mainConn = db;

    //Check if admin features are on
    if (config.mongodb.admin === true) {

      if (config.mongodb.adminUsername.length === 0) {
        if (config.options.console) console.log(&#x27;Admin Database connected&#x27;);
        updateDatabases(adminDb);
      } else {
        //auth details were supplied, authenticate admin account with them
        adminDb.authenticate(config.mongodb.adminUsername, config.mongodb.adminPassword, function (err) {
          if (err) {
            //TODO: handle error
            console.error(err);
          }

          if (config.options.console) console.log(&#x27;Admin Database connected&#x27;);
          updateDatabases(adminDb);
        });
      }
    } else {
      //Regular user authentication
      if (typeof config.mongodb.auth === &#x27;undefined&#x27; || config.mongodb.auth.length === 0) {
        throw new Error(&#x27;Add auth details to config or turn on admin!&#x27;);
      }

      async.forEachSeries(config.mongodb.auth, function (auth, callback) {
        if (config.options.console) console.log(&#x27;Connecting to &#x27; + auth.database + &#x27;...&#x27;);
        connections[auth.database] = mainConn.db(auth.database);
        databases.push(auth.database);

        if (typeof auth.username !== &#x27;undefined&#x27; &#x26;&#x26; auth.username.length !== 0) {
          connections[auth.database].authenticate(auth.username, auth.password, function (err, success) {
            if (err) { ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...

    if (config.mongodb.blacklist.length !== 0) {
      if (_.includes(config.mongodb.blacklist, dbName)) {
        continue;
      }
    }

    connections[dbName] = mainConn.<span class="apidocCodeKeywordSpan">db</span>(dbName);
    databases.push(dbName);
    updateCollections(connections[dbName], dbName);
  }
}

//Sort database names
databases = databases.sort();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mongo-express.filters" id="apidoc.module.mongo-express.filters">module mongo-express.filters</a></h1>


    <h2>
        <a href="#apidoc.element.mongo-express.filters.convertBytes" id="apidoc.element.mongo-express.filters.convertBytes">
        function <span class="apidocSignatureSpan">mongo-express.filters.</span>convertBytes
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">convertBytes = function (input) {
  input = parseInt(input, 10);
  if (input &#x3c; 1024) {
    return input.toString() + &#x27; Bytes&#x27;;
  } else if (input &#x3c; 1024 * 1024) {
    //Convert to KB and keep 2 decimal values
    input = Math.round((input / 1024) * 100) / 100;
    return input.toString() + &#x27; KB&#x27;;
  } else if (input &#x3c; 1024 * 1024 * 1024) {
    input = Math.round((input / (1024 * 1024)) * 100) / 100;
    return input.toString() + &#x27; MB&#x27;;
  } else if (input &#x3c; 1024 * 1024 * 1024 * 1024) {
    input = Math.round((input / (1024 * 1024 * 1024)) * 100) / 100;
    return input.toString() + &#x27; GB&#x27;;
  } else if (input &#x3c; 1024 * 1024 * 1024 * 1024 * 1024) {
    input = Math.round((input / (1024 * 1024 * 1024 * 1024)) * 100) / 100;
    return input.toString() + &#x27; TB&#x27;;
  } else {
    return input.toString() + &#x27; Bytes&#x27;;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.filters.is_embeddedDocumentNotation" id="apidoc.element.mongo-express.filters.is_embeddedDocumentNotation">
        function <span class="apidocSignatureSpan">mongo-express.filters.</span>is_embeddedDocumentNotation
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">is_embeddedDocumentNotation = function (input) {
  return /^(?:[a-zA-Z0-9_]+\.)+[a-zA-Z0-9_]+/.test(input);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.filters.json" id="apidoc.element.mongo-express.filters.json">
        function <span class="apidocSignatureSpan">mongo-express.filters.</span>json
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">json = function (input) {
  return JSON.stringify(input, null, &#x27;    &#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.filters.stringDocIDs" id="apidoc.element.mongo-express.filters.stringDocIDs">
        function <span class="apidocSignatureSpan">mongo-express.filters.</span>stringDocIDs
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stringDocIDs = function (input) {

  // Turns {_bsontype: &#x27; ObjectID&#x27;, id:12345... } into a plain string
  if (input &#x26;&#x26; typeof input === &#x27;object&#x27; &#x26;&#x26; input._bsontype === &#x27;ObjectID&#x27;) {
    return input.toString();
  }

  return input;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.filters.to_display" id="apidoc.element.mongo-express.filters.to_display">
        function <span class="apidocSignatureSpan">mongo-express.filters.</span>to_display
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">to_display = function (input) {

  var entifyGTLTAmp = function (text) {
    // Turn &#x3c; ? &#x3e; into HTML entities, so data doesn&#x27;t get interpreted by the browser
    return text.replace(/&#x26;/g, &#x27;&#x26;amp;&#x27;)
      .replace(/&#x3c;/g, &#x27;&#x26;lt;&#x27;)
      .replace(/&#x3e;/g, &#x27;&#x26;gt;&#x27;)
      .replace(/&#x22;/g, &#x27;&#x26;quot;&#x27;)
      .replace(/&#x27;/g, &#x27;&#x26;apos;&#x27;);
  };

  var retHTML = &#x27;&#x27;;

  // Get nulls out of the way
  if (input === null || input === undefined) {
    return &#x27;&#x27;;
  }

  // Large property
  if (
    typeof input === &#x27;object&#x27; &#x26;&#x26;
    input.display &#x26;&#x26;
    input.display === &#x27;*** LARGE PROPERTY ***&#x27; &#x26;&#x26;
    input.preview &#x26;&#x26;
    input.roughSz &#x26;&#x26;
    input.humanSz &#x26;&#x26;
    input.attribu &#x26;&#x26;
    input.maxSize &#x26;&#x26;
    input._id
  ) {
    retHTML += &#x27;&#x3c;div class=&#x22;tooDamnBig&#x22; doc_id=&#x22;&#x27; + encodeURIComponent(JSON.stringify(input._id)) + &#x27;&#x22; &#x27; +
      &#x27;doc_prop=&#x22;&#x27; + input.attribu + &#x27;&#x22; title=&#x22;Max prop size: &#x27; + input.maxSize + &#x27;&#x22;&#x3e;&#x27;;
    retHTML += input.display + &#x27;&#x3c;br&#x3e;~&#x27; + input.humanSz;
    retHTML += &#x27;&#x3c;br&#x3e;Preview:&#x27; + input.preview;
    retHTML += &#x27;&#x3c;br&#x3e;Click to fetch this property&#x27;;
    retHTML += &#x27;&#x3c;/div&#x3e;&#x27;;
    return retHTML;
  }

  // Large row
  if (
    typeof input === &#x27;object&#x27; &#x26;&#x26;
    input.display &#x26;&#x26;
    input.display === &#x27;*** LARGE ROW ***&#x27; &#x26;&#x26;
    input.preview &#x26;&#x26;
    input.roughSz &#x26;&#x26;
    input.humanSz &#x26;&#x26;
    input.attribu &#x26;&#x26;
    input.maxSize &#x26;&#x26;
    input._id
  ) {
    retHTML += &#x27;&#x3c;div class=&#x22;tooDamnBig&#x22; doc_id=&#x22;&#x27; + encodeURIComponent(JSON.stringify(input._id)) + &#x27;&#x22; &#x27; +
      &#x27;doc_prop=&#x22;&#x27; + input.attribu + &#x27;&#x22; title=&#x22;Max row size: &#x27; + input.maxSize + &#x27;&#x22;&#x3e;&#x27;;
    retHTML += input.display + &#x27;&#x3c;br&#x3e;&#x27; + input.attribu + &#x27;: ~&#x27; + input.humanSz;
    retHTML += &#x27;&#x3c;br&#x3e;Preview:&#x27; + input.preview;
    retHTML += &#x27;&#x3c;br&#x3e;Click to fetch this property&#x27;;
    retHTML += &#x27;&#x3c;/div&#x3e;&#x27;;
    return retHTML;
  }

  // Images inline
  if (
    typeof input === &#x27;string&#x27; &#x26;&#x26;
    (
      input.substr(0, 22) === &#x27;data:image/png;base64,&#x27; ||
      input.substr(0, 22) === &#x27;data:image/gif;base64,&#x27; ||
      input.substr(0, 22) === &#x27;data:image/jpg;base64,&#x27; ||
      input.substr(0, 23) === &#x27;data:image/jpeg;base64,&#x27;
    )
  )  {
    return &#x27;&#x3c;img src=&#x22;&#x27; + input + &#x27;&#x22; style=&#x22;max-height:100%; max-width:100%; &#x22;/&#x3e;&#x27;;
  }

  // Audio inline
  if (
    typeof input === &#x27;string&#x27; &#x26;&#x26;
    (
      input.substr(0, 22) === &#x27;data:audio/ogg;base64,&#x27; ||
      input.substr(0, 22) === &#x27;data:audio/mp3;base64,&#x27;
    )
  )  {
    return &#x27;&#x3c;audio controls style=&#x22;width:45px;&#x22; src=&#x22;&#x27; + input + &#x27;&#x22;&#x3e;Your browser does not support the audio element.&#x3c;/audio&#x3e;&#x27;;
  }

  // Video inline
  if (
    typeof input === &#x27;string&#x27; &#x26;&#x26;
    (
      input.substr(0, 23) === &#x27;data:video/webm;base64,&#x27; ||
      input.substr(0, 22) === &#x27;data:video/mp4;base64,&#x27;  ||
      input.substr(0, 22) === &#x27;data:video/ogv;base64,&#x27;
    )
  )  {
    return &#x27;&#x3c;video controls&#x3e;&#x3c;source type=&#x22;&#x27; + input.substring(input.indexOf(&#x27;:&#x27;) + 1, input.indexOf(&#x27;;&#x27;)) + &#x27;&#x22; src=&#x22;&#x27; + input + &#x27;&#x22;/&#x3e;&#x27; +
      &#x27;Your browser does not support the video element.&#x3c;/video&#x3e;&#x27;;
  }

  if (typeof input === &#x27;object&#x27; &#x26;&#x26; input.toString().substr(0, 15) === &#x27;[object Object]&#x27;) {
    return &#x27;&#x3c;pre&#x3e;&#x27; + JSON.stringify(input, null, 2) + &#x27;&#x3c;/pre&#x3e;&#x27;;
  }

  // Concatenate long strings
  if (typeof input === &#x27;string&#x27; &#x26;&#x26; input.length &#x3e; 50) {
    return entifyGTLTAmp(input.substr(0, 49) + &#x27;…&#x27;);
  }

  // Return basic .toString() since we&#x27;ve tried all other cases
  return entifyGTLTAmp(input.toString());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.filters.to_string" id="apidoc.element.mongo-express.filters.to_string">
        function <span class="apidocSignatureSpan">mongo-express.filters.</span>to_string
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">to_string = function (input) {
  return (input !== null &#x26;&#x26; input !== undefined) ? input.toString() : &#x27;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mongo-express.json" id="apidoc.module.mongo-express.json">module mongo-express.json</a></h1>


    <h2>
        <a href="#apidoc.element.mongo-express.json.stringify" id="apidoc.element.mongo-express.json.stringify">
        function <span class="apidocSignatureSpan">mongo-express.json.</span>stringify
        <span class="apidocSignatureSpan">(value, replacer, space)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stringify = function (value, replacer, space) {

  // The stringify method takes a value and an optional replacer, and an optional
  // space parameter, and returns a JSON text. The replacer can be a function
  // that can replace values, or an array of strings that will select the keys.
  // A default replacer method can be provided. Use of the space parameter can
  // produce text that is more easily readable.

  var i;
  gap = &#x27;&#x27;;
  indent = &#x27;&#x27;;

  // If the space parameter is a number, make an indent string containing that
  // many spaces.

  if (typeof space === &#x27;number&#x27;) {
    for (i = 0; i &#x3c; space; i += 1) {
      indent += &#x27; &#x27;;
    }

  // If the space parameter is a string, it will be used as the indent string.

  } else if (typeof space === &#x27;string&#x27;) {
    indent = space;
  }

  // If there is a replacer, it must be a function or an array.
  // Otherwise, throw an error.

  rep = replacer;
  if (replacer &#x26;&#x26; typeof replacer !== &#x27;function&#x27; &#x26;&#x26;
          (typeof replacer !== &#x27;object&#x27; ||
          typeof replacer.length !== &#x27;number&#x27;)) {
    throw new Error(&#x27;JSON.stringify&#x27;);
  }

  // Make a fake root object containing our value under the key of &#x27;&#x27;.
  // Return the result of stringifying the value.

  return str(&#x27;&#x27;, { &#x27;&#x27;: value });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    console.log();
    console.error(clc.red(&#x27;Address &#x27; + addressString + &#x27; already in use! You need to pick a different host and/or
 port.&#x27;));
    console.log(&#x27;Maybe mongo-express is already running?&#x27;);
  }

  console.log();
  console.log(&#x27;If you are still having trouble, try Googling for the key parts of the following error object before posting
 an issue&#x27;);
  console.log(JSON.<span class="apidocCodeKeywordSpan">stringify</span>(e));
  return process.exit(1);
});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mongo-express.middleware" id="apidoc.module.mongo-express.middleware">module mongo-express.middleware</a></h1>


    <h2>
        <a href="#apidoc.element.mongo-express.middleware.middleware" id="apidoc.element.mongo-express.middleware.middleware">
        function <span class="apidocSignatureSpan">mongo-express.</span>middleware
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">middleware = function (config) {
  const app = express();

  app.locals.assets = assets;

  //Set up swig
  const swigOptions = {
    cache: process.env.NODE_ENV === &#x27;production&#x27; ? &#x27;memory&#x27; : false,
  };
  const swigEngine = new swig.Swig(swigOptions);
  app.engine(&#x27;html&#x27;, swigEngine.renderFile);
  Object.keys(swigFilters).forEach(function (name) {
    swig.setFilter(name, swigFilters[name]);
  });

  //App configuration
  app.set(&#x27;views&#x27;, __dirname + &#x27;/views&#x27;);
  app.set(&#x27;view engine&#x27;, &#x27;html&#x27;);
  app.set(&#x27;view options&#x27;, { layout: false });

  app.use(&#x27;/&#x27;, router(config));

  app.set(&#x27;read_only&#x27;,      config.options.readOnly      || false);
  app.set(&#x27;gridFSEnabled&#x27;,  config.options.gridFSEnabled || false);

  return app;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mongo-express.router" id="apidoc.module.mongo-express.router">module mongo-express.router</a></h1>


    <h2>
        <a href="#apidoc.element.mongo-express.router.router" id="apidoc.element.mongo-express.router.router">
        function <span class="apidocSignatureSpan">mongo-express.</span>router
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">router = function (config) {
  // appRouter configuration
  const appRouter = express.Router();
  const mongo = db(config);

  if (config.useBasicAuth) {
    appRouter.use(basicAuth(config.basicAuth.username, config.basicAuth.password));
  }

  appRouter.use(favicon(__dirname + &#x27;/../public/images/favicon.ico&#x27;));

  appRouter.use(logger(&#x27;dev&#x27;, config.options.logger));

  appRouter.use(&#x27;/public&#x27;, express.static(__dirname + &#x27;/../build/&#x27;));

  // Set request size limit
  appRouter.use(bodyParser.urlencoded({
    extended: true,
    limit: config.site.requestSizeLimit,
  }));

  appRouter.use(cookieParser(config.site.cookieSecret));

  appRouter.use(session({
    key: config.site.cookieKeyName,
    resave: true,
    saveUninitialized: true,
    secret: config.site.sessionSecret,
  }));

  appRouter.use(methodOverride(function (req) {
    if (req.body &#x26;&#x26; typeof req.body === &#x27;object&#x27; &#x26;&#x26; &#x27;_method&#x27; in req.body) {
      // look in urlencoded POST bodies and delete it
      const method = req.body._method;
      delete req.body._method;
      return method;
    }
  }));

  if (process.env.NODE_ENV === &#x27;development&#x27;) {
    appRouter.use(errorHandler());
  }

  const addTrailingSlash = function (s) {
    return s + (s[s.length - 1] === &#x27;/&#x27; ? &#x27;&#x27; : &#x27;/&#x27;);
  };
  const buildBaseHref = function (originalUrl, reqUrl) {
    if (reqUrl === &#x27;/&#x27;) {
      return addTrailingSlash(originalUrl);
    }
    const idx = originalUrl.lastIndexOf(reqUrl);
    const rootPath = originalUrl.substring(0, idx);
    return addTrailingSlash(rootPath);
  };

  // View helper, sets local variables used in templates
  appRouter.all(&#x27;*&#x27;, function (req, res, next) {
    res.locals.baseHref       = buildBaseHref(req.originalUrl, req.url);
    res.locals.databases      = mongo.databases;
    res.locals.collections    = mongo.collections;
    res.locals.gridFSBuckets  = utils.colsToGrid(mongo.collections);

    // Flash messages
    if (req.session.success) {
      res.locals.messageSuccess = req.session.success;
      delete req.session.success;
    }

    if (req.session.error) {
      res.locals.messageError = req.session.error;
      delete req.session.error;
    }

    if (config.mongodb.admin !== true) return next();

    mongo.updateDatabases(mongo.adminDb, function (databases) {
      mongo.databases = databases;
      res.locals.databases = mongo.databases;
      return next();
    });
  });

  // route param pre-conditions
  appRouter.param(&#x27;database&#x27;, function (req, res, next, id) {
    //Make sure database exists
    if (!_.includes(mongo.databases, id)) {
      req.session.error = &#x27;Database not found!&#x27;;
      return res.redirect(res.locals.baseHref);
    }

    req.dbName = id;
    res.locals.dbName = id;

    if (mongo.connections[id] !== undefined) {
      req.db = mongo.connections[id];
    } else {
      mongo.connections[id] = mongo.mainConn.db(id);
      req.db = mongo.connections[id];
    }

    next();
  });

  // :collection param MUST be preceded by a :database param
  appRouter.param(&#x27;collection&#x27;, function (req, res, next, id) {
    //Make sure collection exists

    if (!_.includes(mongo.collections[req.dbName], id)) {
      req.session.error = &#x27;Collection not found!&#x27;;
      return res.redirect(res.locals.baseHref + &#x27;db/&#x27; + req.dbName);
    }

    req.collectionName = id;
    res.locals.collectionName = id;
    res.locals.collections = mongo.collections[req.dbName];
    res.locals.gridFSBuckets = utils.colsToGrid(mongo.collections[req.dbName]);

    mongo.connections[req.dbName].collection(id, function (err, coll) {
      if (err || coll === null) {
        req.session.error = &#x27;Collection not found!&#x27;;
        return res.redirect(res.locals.baseHref + &#x27;db/&#x27; + req.dbName);
      }

      req.collection = coll;

      next();
    });
  });

  // :document param MUST be preceded by a :collection param
  appRouter.param(&#x27;document&#x27;, function (req, res, next, id) {
    if (id === &#x27;undefined&#x27; || id === undefined) {
      req.session.error = &#x27;Document lacks an _id!&#x27;;
      return res.redirect(res.locals.baseHref + &#x27;db/&#x27; + req.dbName + &#x27;/&#x27; + req.collectionName); ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mongo-express.utils" id="apidoc.module.mongo-express.utils">module mongo-express.utils</a></h1>


    <h2>
        <a href="#apidoc.element.mongo-express.utils.buildCollectionURL" id="apidoc.element.mongo-express.utils.buildCollectionURL">
        function <span class="apidocSignatureSpan">mongo-express.utils.</span>buildCollectionURL
        <span class="apidocSignatureSpan">(base, dbName, collectionName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">buildCollectionURL = function (base, dbName, collectionName) {
  return base + &#x27;db/&#x27; + dbName + &#x27;/&#x27; + encodeURIComponent(collectionName);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.utils.bytesToSize" id="apidoc.element.mongo-express.utils.bytesToSize">
        function <span class="apidocSignatureSpan">mongo-express.utils.</span>bytesToSize
        <span class="apidocSignatureSpan">(bytes)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bytesToSize(bytes) {
  if (bytes === 0) return &#x27;0 Byte&#x27;;
  var k = 1000;
  var sizes = [&#x27;Bytes&#x27;, &#x27;KB&#x27;, &#x27;MB&#x27;, &#x27;GB&#x27;, &#x27;TB&#x27;, &#x27;PB&#x27;, &#x27;EB&#x27;, &#x27;ZB&#x27;, &#x27;YB&#x27;];
  var i = Math.floor(Math.log(bytes) / Math.log(k));
  return (bytes / Math.pow(k, i)).toPrecision(3) + &#x27; &#x27; + sizes[i];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.utils.colsToGrid" id="apidoc.element.mongo-express.utils.colsToGrid">
        function <span class="apidocSignatureSpan">mongo-express.utils.</span>colsToGrid
        <span class="apidocSignatureSpan">(cols)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">colsToGrid = function (cols) {
  // Generate list of GridFS buckets
  // takes databases, filters by having suffix of &#x27;.files&#x27; and also a corresponding &#x27;.chunks&#x27; in the DB list, then returns just
the prefix name.

  // cols comes in an object of all databases and all their collections
  // return an object of all databases and all potential GridFS x.files &#x26; x.chunks

  var rets = _.clone(cols);

  _.each(rets, (val, key) =&#x3e; {
    rets[key] = _.map(
      _.filter(rets[key], col =&#x3e;
        col.toString().substr(-6) === &#x27;.files&#x27; &#x26;&#x26; _.intersection(rets[key], [col.toString().slice(0, -6) + &#x27;.chunks&#x27;])
      ),
      col =&#x3e; col.toString().slice(0, -6)
    ).sort();
  });

  return rets;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  };

  // View helper, sets local variables used in templates
  appRouter.all(&#x27;*&#x27;, function (req, res, next) {
res.locals.baseHref       = buildBaseHref(req.originalUrl, req.url);
res.locals.databases      = mongo.databases;
res.locals.collections    = mongo.collections;
res.locals.gridFSBuckets  = utils.<span class="apidocCodeKeywordSpan">colsToGrid</span>(mongo.collections);

// Flash messages
if (req.session.success) {
  res.locals.messageSuccess = req.session.success;
  delete req.session.success;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.utils.deepmerge" id="apidoc.element.mongo-express.utils.deepmerge">
        function <span class="apidocSignatureSpan">mongo-express.utils.</span>deepmerge
        <span class="apidocSignatureSpan">(target, src)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">deepmerge = function (target, src) {
  var array = Array.isArray(src);
  var dst = array ? [] : {};

  if (array) {
    target = target || [];
    dst = dst.concat(target);
    src.forEach(function (e, i) {
      if (typeof dst[i] === &#x27;undefined&#x27;) {
        dst[i] = e;
      } else if (typeof e === &#x27;object&#x27;) {
        dst[i] = exports.deepmerge(target[i], e);
      } else {
        if (target.indexOf(e) === -1) {
          dst.push(e);
        }
      }
    });
  } else {
    if (target &#x26;&#x26; typeof target === &#x27;object&#x27;) {
      Object.keys(target).forEach(function (key) {
        dst[key] = target[key];
      });
    }

    Object.keys(src).forEach(function (key) {
      if (typeof src[key] !== &#x27;object&#x27; || !src[key]) {
        dst[key] = src[key];
      } else {
        if (!target[key]) {
          dst[key] = src[key];
        } else {
          dst[key] = exports.deepmerge(target[key], src[key]);
        }
      }
    });
  }

  return dst;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
let sslOptions;

// Notify of any updates
notifier.notify();

try {
// eslint-disable-next-line import/no-unresolved
config = utils.<span class="apidocCodeKeywordSpan">deepmerge</span>(require(&#x27;./config.default&#x27;), require(&#x27;./config
&#x27;));
} catch (e) {
if (e.code === &#x27;MODULE_NOT_FOUND&#x27;) {
  console.log(&#x27;No custom config.js found, loading config.default.js&#x27;);
} else {
  console.error(clc.red(&#x27;Unable to load config.js!&#x27;));
  console.error(clc.red(&#x27;Error is:&#x27;));
  console.log(clc.red(e));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mongo-express.utils.roughSizeOfObject" id="apidoc.element.mongo-express.utils.roughSizeOfObject">
        function <span class="apidocSignatureSpan">mongo-express.utils.</span>roughSizeOfObject
        <span class="apidocSignatureSpan">(object)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">roughSizeOfObject = function (object) {

  var objectList = [];
  var recurse = function (value) {
    var bytes = 0;

    if (typeof value === &#x27;boolean&#x27;) {
      bytes = 4;
    } else if (typeof value === &#x27;string&#x27;) {
      bytes = value.length * 2;
    } else if (typeof value === &#x27;number&#x27;) {
      bytes = 8;
    } else if (typeof value === &#x27;object&#x27; &#x26;&#x26; objectList.indexOf(value) === -1) {
      objectList[objectList.length] = value;

      for (var i in value) {
        bytes += 8; // an assumed existence overhead
        bytes += recurse(value[i]);
      }
    }

    return bytes;
  };

  return recurse(object);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
